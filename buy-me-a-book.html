<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy Me a Book - Gift Books, Share Stories</title>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@300;400;600;700&family=Libre+Baskerville:wght@400;700&family=Spectral:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --parchment: #f4f1e8;
            --ink: #2c2416;
            --sepia: #8b7355;
            --leather: #5d4e37;
            --gold: #d4af37;
            --forest: #3a5a40;
            --cream: #fffef7;
            --shadow: rgba(44, 36, 22, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Spectral', serif;
            background: linear-gradient(135deg, var(--parchment) 0%, var(--cream) 100%);
            color: var(--ink);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(212, 175, 55, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(58, 90, 64, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            padding: 3rem 0 4rem;
            animation: fadeInDown 0.8s ease-out;
        }

        h1 {
            font-family: 'Libre Baskerville', serif;
            font-size: 3.5rem;
            color: var(--leather);
            margin-bottom: 0.5rem;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .tagline {
            font-family: 'Crimson Pro', serif;
            font-size: 1.3rem;
            color: var(--sepia);
            font-style: italic;
            font-weight: 300;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0 3rem;
            flex-wrap: wrap;
        }

        .tab-btn {
            font-family: 'Crimson Pro', serif;
            padding: 0.8rem 2rem;
            background: var(--cream);
            border: 2px solid var(--leather);
            color: var(--leather);
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 2px;
            font-weight: 600;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .tab-btn:hover {
            background: var(--leather);
            color: var(--cream);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .tab-btn.active {
            background: var(--leather);
            color: var(--gold);
            border-color: var(--gold);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: var(--cream);
            border: 1px solid rgba(93, 78, 55, 0.2);
            border-radius: 4px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px var(--shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(44, 36, 22, 0.15);
        }

        h2 {
            font-family: 'Libre Baskerville', serif;
            color: var(--leather);
            margin-bottom: 1.5rem;
            font-size: 2rem;
            border-left: 4px solid var(--gold);
            padding-left: 1rem;
        }

        h3 {
            font-family: 'Crimson Pro', serif;
            color: var(--forest);
            margin-bottom: 1rem;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--leather);
            font-weight: 600;
            font-family: 'Crimson Pro', serif;
        }

        input, textarea, select {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid rgba(93, 78, 55, 0.3);
            background: white;
            font-family: 'Spectral', serif;
            font-size: 1rem;
            border-radius: 2px;
            transition: border-color 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--gold);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            font-family: 'Crimson Pro', serif;
            padding: 1rem 2.5rem;
            background: var(--leather);
            color: var(--cream);
            border: none;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 2px;
            font-weight: 600;
            box-shadow: 0 4px 12px var(--shadow);
        }

        .btn:hover {
            background: var(--forest);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(44, 36, 22, 0.2);
        }

        .btn-secondary {
            background: var(--gold);
            color: var(--ink);
        }

        .btn-secondary:hover {
            background: #c99c2e;
        }

        .book-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .book-item {
            background: white;
            border: 1px solid rgba(93, 78, 55, 0.2);
            border-radius: 4px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px var(--shadow);
            transition: all 0.3s ease;
            position: relative;
        }

        .book-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 20px rgba(44, 36, 22, 0.15);
        }

        .book-item.fulfilled {
            opacity: 0.7;
            background: #f8f9fa;
        }

        .book-item.fulfilled:hover {
            transform: none;
        }

        .fulfilled-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
            transform: rotate(5deg);
            font-family: 'Crimson Pro', serif;
            letter-spacing: 0.5px;
            z-index: 10;
        }

        .fulfilled-badge::before {
            content: '‚úì ';
            font-size: 1.1rem;
        }

        .active-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, var(--gold) 0%, #c99c2e 100%);
            color: var(--ink);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
            font-family: 'Crimson Pro', serif;
            letter-spacing: 0.5px;
            z-index: 10;
        }

        .book-title {
            font-family: 'Libre Baskerville', serif;
            font-size: 1.2rem;
            color: var(--leather);
            margin-bottom: 0.5rem;
        }

        .book-author {
            color: var(--sepia);
            font-style: italic;
            margin-bottom: 0.5rem;
        }

        .book-requester {
            color: var(--forest);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .book-price {
            font-size: 1.3rem;
            color: var(--gold);
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--leather) 0%, var(--forest) 100%);
            color: var(--cream);
            padding: 2rem;
            border-radius: 4px;
            text-align: center;
            box-shadow: 0 4px 15px var(--shadow);
        }

        .stat-number {
            font-family: 'Libre Baskerville', serif;
            font-size: 2.5rem;
            font-weight: 700;
            display: block;
            margin-bottom: 0.5rem;
            color: var(--gold);
        }

        .stat-label {
            font-family: 'Crimson Pro', serif;
            font-size: 1rem;
            opacity: 0.9;
        }

        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .step {
            text-align: center;
            padding: 2rem;
        }

        .step-number {
            display: inline-block;
            width: 60px;
            height: 60px;
            background: var(--gold);
            color: var(--ink);
            border-radius: 50%;
            font-family: 'Libre Baskerville', serif;
            font-size: 1.8rem;
            font-weight: 700;
            line-height: 60px;
            margin-bottom: 1rem;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        .step h3 {
            margin-bottom: 0.5rem;
        }

        footer {
            text-align: center;
            padding: 3rem 0 2rem;
            margin-top: 4rem;
            border-top: 2px solid rgba(93, 78, 55, 0.2);
            color: var(--sepia);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
            .tagline {
                font-size: 1.1rem;
            }
            .book-list {
                grid-template-columns: 1fr;
            }
        }

        .amazon-btn {
            background: #ff9900;
            color: #232f3e;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 3px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            font-size: 1rem;
        }

        .amazon-btn:hover {
            background: #ffad33;
            transform: translateY(-2px);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--forest);
            color: var(--cream);
            padding: 1rem 2rem;
            border-radius: 4px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            display: none;
            animation: slideIn 0.5s ease-out;
            z-index: 1000;
        }

        .filter-btn {
            font-family: 'Crimson Pro', serif;
            padding: 0.8rem 1.5rem;
            background: var(--cream);
            border: 2px solid var(--leather);
            color: var(--leather);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 2px;
            font-weight: 600;
            box-shadow: 0 2px 8px var(--shadow);
        }

        .filter-btn:hover {
            background: var(--leather);
            color: var(--cream);
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: var(--leather);
            color: var(--gold);
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <div class="container">
        <header>
            <h1>üìö Buy Me a Book</h1>
            <p class="tagline">Share the gift of reading, one page at a time</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('browse')">Browse Requests</button>
            <button class="tab-btn" onclick="switchTab('donate')">Buy Books for Others</button>
            <button class="tab-btn" onclick="switchTab('gifted')">Gifted Books</button>
            <button class="tab-btn" onclick="switchTab('all-requests')">All Requests</button>
            <button class="tab-btn" onclick="switchTab('request')">Request a Book</button>
            <button class="tab-btn" onclick="switchTab('how')">How It Works</button>
        </div>

        <!-- Browse Requests Tab -->
        <div id="browse" class="tab-content active">
            <div class="card">
                <h2>Book Requests Awaiting Your Kindness</h2>
                
                <div class="stats">
                    <div class="stat-card">
                        <span class="stat-number" id="totalRequests">0</span>
                        <span class="stat-label">Books Requested</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="totalFulfilled">0</span>
                        <span class="stat-label">Books Gifted</span>
                    </div>
                </div>

                <div style="text-align: center; margin: 2rem 0;">
                    <button class="btn btn-secondary" onclick="goToRequestTab()" style="font-size: 1.2rem; padding: 1.2rem 3rem;">
                        üìñ Request a Kindle Book
                    </button>
                    <p style="color: var(--sepia); margin-top: 1rem; font-size: 0.95rem;">
                        Need a book but can't afford it? Request it and generous donors will help!
                    </p>
                </div>

                <div class="book-list" id="bookList"></div>
            </div>
        </div>

        <!-- Donate/Buy Books Tab -->
        <div id="donate" class="tab-content">
            <div class="card">
                <h2>üéÅ Buy Kindle Books for Others</h2>
                <p style="margin-bottom: 2rem; color: var(--sepia); font-size: 1.1rem;">
                    Welcome, generous soul! Browse Kindle book requests and purchase digital books to gift directly to readers in need.
                </p>

                <div style="background: linear-gradient(135deg, var(--gold) 0%, #e0c050 100%); padding: 2rem; border-radius: 8px; margin-bottom: 2rem; box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);">
                    <h3 style="color: var(--ink); margin-bottom: 1rem;">üåü How to Gift a Kindle Book</h3>
                    <ol style="color: var(--ink); font-size: 1rem; line-height: 1.8; padding-left: 1.5rem;">
                        <li>Browse the Kindle book requests below</li>
                        <li>Click "Buy Kindle Edition" for any book you'd like to gift</li>
                        <li>On Amazon, select "Buy for someone else" or "Give as a Gift"</li>
                        <li>Enter the recipient's Kindle email address provided</li>
                        <li>Complete purchase - the book is delivered instantly to their Kindle!</li>
                    </ol>
                </div>

                <div style="margin-bottom: 2rem;">
                    <h3>üìö Available Kindle Book Requests</h3>
                    <p style="color: var(--sepia); margin-bottom: 1rem;">Click on any book to purchase the Kindle edition and gift it instantly.</p>
                </div>

                <div class="book-list" id="donateBookList"></div>
            </div>
        </div>

        <!-- Gifted Books Tab -->
        <div id="gifted" class="tab-content">
            <div class="card">
                <h2>üéâ Gifted Books - Thank You, Donors!</h2>
                <p style="margin-bottom: 2rem; color: var(--sepia); font-size: 1.1rem;">
                    These wonderful books have been gifted by generous donors. Thank you for changing lives through reading!
                </p>

                <div style="background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); padding: 2rem; border-radius: 8px; margin-bottom: 2rem; box-shadow: 0 4px 20px rgba(46, 204, 113, 0.3);">
                    <h3 style="color: white; margin-bottom: 1rem;">‚ú® Community Impact</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1.5rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: 700; color: white;" id="giftedCount">0</div>
                            <div style="color: rgba(255,255,255,0.9);">Books Gifted</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; font-weight: 700; color: white;" id="giftedValue">$0</div>
                            <div style="color: rgba(255,255,255,0.9);">Total Value</div>
                        </div>
                    </div>
                </div>

                <div class="book-list" id="giftedBookList"></div>
            </div>
        </div>

        <!-- All Requests Tab -->
        <div id="all-requests" class="tab-content">
            <div class="card">
                <h2>üìã All Book Requests</h2>
                <p style="margin-bottom: 2rem; color: var(--sepia); font-size: 1.1rem;">
                    Complete list of all book requests - both active and fulfilled.
                </p>

                <div style="display: flex; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap;">
                    <button class="filter-btn active" onclick="filterRequests('all')" id="filterAll">
                        All Books (<span id="countAll">0</span>)
                    </button>
                    <button class="filter-btn" onclick="filterRequests('active')" id="filterActive">
                        Active (<span id="countActive">0</span>)
                    </button>
                    <button class="filter-btn" onclick="filterRequests('fulfilled')" id="filterFulfilled">
                        Gifted (<span id="countFulfilled">0</span>)
                    </button>
                </div>

                <div class="book-list" id="allRequestsList"></div>
            </div>
        </div>

        <!-- Request a Book Tab -->
        <div id="request" class="tab-content">
            <div class="card">
                <h2>Request a Kindle Book</h2>
                <p style="margin-bottom: 2rem; color: var(--sepia);">Request a Kindle book you need but can't afford. Generous donors will purchase it and gift it directly to your Kindle email address!</p>
                
                <form id="requestForm" onsubmit="submitRequest(event)">
                    <div class="form-group">
                        <label for="reqName">Your Name</label>
                        <input type="text" id="reqName" required placeholder="Jane Doe">
                    </div>
                    
                    <div class="form-group">
                        <label for="reqEmail">Your Email</label>
                        <input type="email" id="reqEmail" required placeholder="jane@example.com">
                        <small style="color: var(--sepia);">We'll notify you when someone gifts you a book</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="bookTitle">Book Title</label>
                        <input type="text" id="bookTitle" required placeholder="To Kill a Mockingbird">
                    </div>
                    
                    <div class="form-group">
                        <label for="bookAuthor">Author</label>
                        <input type="text" id="bookAuthor" required placeholder="Harper Lee">
                    </div>
                    
                    <div class="form-group">
                        <label for="amazonLink">Amazon Kindle Book Link *</label>
                        <input type="url" id="amazonLink" required placeholder="https://www.amazon.com/...">
                        <small style="color: var(--sepia);">
                            <strong>Required:</strong> Go to Amazon, find the exact Kindle edition you want, and paste the link here.
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="kindleEmail">Your Kindle Email Address *</label>
                        <input type="email" id="kindleEmail" required placeholder="yourname@kindle.com">
                        <small style="color: var(--sepia);">
                            <strong>Find your Kindle email:</strong> Amazon account ‚Üí Content & Devices ‚Üí Preferences ‚Üí Personal Document Settings. 
                            It looks like "yourname@kindle.com" or "yourname_123@kindle.com"
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="whyBook">Why do you want this book?</label>
                        <textarea id="whyBook" required placeholder="Share your story... Why is this book important to you?"></textarea>
                    </div>
                    
                    <button type="submit" class="btn">Submit Book Request</button>
                </form>
            </div>
        </div>

        <!-- How It Works Tab -->
        <div id="how" class="tab-content">
            <div class="card">
                <h2>How It Works</h2>
                
                <h3 style="margin-top: 2rem; text-align: center; color: var(--leather);">For People Who Need Books</h3>
                <div class="steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <h3>Find Your Book</h3>
                        <p>Go to Amazon and find the exact Kindle book you want. Copy the link.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <h3>Post Request</h3>
                        <p>Fill out the form with book details, your Kindle email, and why you need it.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <h3>Receive Your Book</h3>
                        <p>When a donor purchases it, the Kindle book is delivered instantly to your Kindle!</p>
                    </div>
                </div>

                <h3 style="margin-top: 3rem; text-align: center; color: var(--leather);">For Generous Donors</h3>
                <div class="steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <h3>Browse Requests</h3>
                        <p>See books people need and read their stories about why each book matters.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <h3>Purchase on Amazon</h3>
                        <p>Click to buy the Kindle edition. Select "Give as a Gift" and use the recipient's Kindle email.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <h3>Change a Life</h3>
                        <p>The book delivers instantly to their Kindle! You've opened a new world through reading!</p>
                    </div>
                </div>

                <div style="background: var(--parchment); padding: 2rem; border-radius: 4px; margin-top: 2rem; border-left: 4px solid var(--gold);">
                    <h3>How the Platform Works</h3>
                    <p><strong>Simple & Transparent:</strong> People in need post Kindle book requests with their Amazon link and Kindle email address. Donors browse requests, purchase Kindle books on Amazon, and gift them directly to the recipient's Kindle.</p>
                    
                    <p style="margin-top: 1rem;"><strong>Instant Digital Delivery:</strong> Kindle books are delivered instantly via email. No physical shipping needed - just the recipient's Kindle email address!</p>
                    
                    <p style="margin-top: 1rem;"><strong>Your Privacy:</strong> Kindle emails are only visible to donors who want to help. We never store payment information - all purchases happen securely through Amazon.</p>
                    
                    <p style="margin-top: 1rem;"><strong>Platform Support:</strong> This platform uses Amazon Affiliate links (tag: samuelkimanis-20). A small percentage of purchases helps cover hosting costs at no extra cost to you.</p>
                </div>
            </div>
        </div>

        <footer>
            <p>Built with ‚ù§Ô∏è for book lovers everywhere</p>
            <p style="margin-top: 0.5rem; font-size: 0.9rem;">Connect readers ‚Ä¢ Share stories ‚Ä¢ Change lives</p>
        </footer>
    </div>

    <script>
        let bookRequests = [
            {
                id: 1,
                title: "Atomic Habits",
                author: "James Clear",
                requester: "Mike Chen",
                email: "mike@example.com",
                kindleEmail: "mikechen_books@kindle.com",
                reason: "I'm trying to build better habits to improve my life. This book has been recommended by so many people.",
                amazonLink: "https://www.amazon.com/dp/B07D23CFGR",
                price: "$13.99",
                fulfilled: false
            },
            {
                id: 2,
                title: "The Midnight Library",
                author: "Matt Haig",
                requester: "Sarah Johnson",
                email: "sarah@example.com",
                kindleEmail: "sarahjohnson_1990@kindle.com",
                reason: "Going through a tough time and I've heard this book offers a beautiful perspective on life's possibilities.",
                amazonLink: "https://www.amazon.com/dp/B08FF8J8XP",
                price: "$11.99",
                fulfilled: false
            },
            {
                id: 3,
                title: "Educated",
                author: "Tara Westover",
                requester: "Alex Rodriguez",
                email: "alex@example.com",
                kindleEmail: "alex.rodriguez@kindle.com",
                reason: "As a first-generation college student, this memoir resonates deeply with my journey.",
                amazonLink: "https://www.amazon.com/dp/B072BLVM83",
                price: "$14.99",
                fulfilled: false
            },
            {
                id: 4,
                title: "Thinking, Fast and Slow",
                author: "Daniel Kahneman",
                requester: "Emma Williams",
                email: "emma@example.com",
                kindleEmail: "emma.w@kindle.com",
                reason: "I want to understand how the mind works and make better decisions in my life and career.",
                amazonLink: "https://www.amazon.com/dp/B00555X8OA",
                price: "$15.99",
                fulfilled: true
            }
        ];

        let stats = {
            totalRequests: 48,
            totalFulfilled: 24
        };

        let currentFilter = 'all';

        function init() {
            updateStats();
            renderBookList();
            renderDonateBookList();
            renderGiftedBookList();
            renderAllRequestsList();
            updateFilterCounts();
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function goToRequestTab() {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('request').classList.add('active');
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.textContent.includes('Request a Book')) {
                    btn.classList.add('active');
                }
            });
        }

        function updateStats() {
            document.getElementById('totalRequests').textContent = stats.totalRequests;
            document.getElementById('totalFulfilled').textContent = stats.totalFulfilled;
        }

        function renderBookList() {
            const bookList = document.getElementById('bookList');
            bookList.innerHTML = '';
            
            bookRequests.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.className = book.fulfilled ? 'book-item fulfilled' : 'book-item';
                bookItem.innerHTML = `
                    ${book.fulfilled ? '<div class="fulfilled-badge">GIFTED</div>' : ''}
                    <div class="book-title">${book.title}</div>
                    <div class="book-author">by ${book.author}</div>
                    <div class="book-requester">Requested by ${book.requester}</div>
                    <p style="color: var(--sepia); font-size: 0.95rem; margin-bottom: 1rem; font-style: italic;">"${book.reason}"</p>
                    ${!book.fulfilled ? `
                        <div style="background: var(--parchment); padding: 0.8rem; border-radius: 4px; margin-bottom: 1rem; font-size: 0.9rem;">
                            <strong>üìß Kindle Email:</strong> ${book.kindleEmail}
                        </div>
                        <div class="book-price">${book.price}</div>
                        <button class="amazon-btn" onclick="giftBook(${book.id})">
                            üéÅ Buy Kindle Book & Gift to ${book.requester.split(' ')[0]}
                        </button>
                        <p style="font-size: 0.85rem; color: var(--sepia); margin-top: 0.5rem; text-align: center;">
                            Click to purchase Kindle edition and gift to ${book.requester.split(' ')[0]}'s Kindle
                        </p>
                    ` : `
                        <div style="text-align: center; padding: 1rem; color: var(--forest); background: rgba(46, 204, 113, 0.1); border-radius: 4px; margin-top: 1rem;">
                            <strong>‚ú® This book has been gifted! Thank you, kind donor!</strong>
                        </div>
                    `}
                `;
                bookList.appendChild(bookItem);
            });

            if (bookRequests.length === 0) {
                bookList.innerHTML = '<p style="text-align: center; color: var(--sepia); padding: 2rem;">No book requests yet. Be the first to request a book!</p>';
            }
        }

        function renderDonateBookList() {
            const donateBookList = document.getElementById('donateBookList');
            donateBookList.innerHTML = '';
            
            bookRequests.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.className = book.fulfilled ? 'book-item fulfilled' : 'book-item';
                bookItem.innerHTML = `
                    ${book.fulfilled ? '<div class="fulfilled-badge">GIFTED</div>' : ''}
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <div style="flex: 1;">
                            <div class="book-title">${book.title}</div>
                            <div class="book-author">by ${book.author}</div>
                        </div>
                        <div class="book-price" style="margin: 0;">${book.price}</div>
                    </div>
                    
                    <div style="background: rgba(93, 78, 55, 0.05); padding: 1rem; border-radius: 4px; margin-bottom: 1rem;">
                        <div style="font-size: 0.9rem; color: var(--forest); margin-bottom: 0.5rem;">
                            <strong>üìñ Requested by:</strong> ${book.requester}
                        </div>
                        <div style="font-size: 0.9rem; color: var(--sepia); font-style: italic; margin-bottom: 0.8rem;">
                            "${book.reason}"
                        </div>
                        ${!book.fulfilled ? `
                            <div style="font-size: 0.85rem; color: var(--leather);">
                                <strong>üìß Kindle Email:</strong> ${book.kindleEmail}
                            </div>
                        ` : ''}
                    </div>
                    
                    ${!book.fulfilled ? `
                        <button class="amazon-btn" onclick="giftBook(${book.id})" style="background: #ff9900; font-size: 1.05rem; padding: 1rem;">
                            üõí Buy Kindle Edition & Gift to ${book.requester.split(' ')[0]}
                        </button>
                        
                        <p style="font-size: 0.8rem; color: var(--sepia); margin-top: 0.8rem; text-align: center; line-height: 1.4;">
                            üíù Digital book delivered instantly to ${book.requester.split(' ')[0]}'s Kindle<br>
                            ‚≠ê Commission supports platform maintenance
                        </p>
                    ` : `
                        <div style="text-align: center; padding: 1.5rem; color: var(--forest); background: rgba(46, 204, 113, 0.1); border-radius: 4px;">
                            <strong style="font-size: 1.1rem;">‚ú® Already Gifted!</strong>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;">A generous donor has already purchased this book for ${book.requester.split(' ')[0]}</p>
                        </div>
                    `}
                `;
                donateBookList.appendChild(bookItem);
            });

            if (bookRequests.length === 0) {
                donateBookList.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--sepia);">
                        <h3 style="color: var(--gold); margin-bottom: 1rem;">üìö No Book Requests Yet</h3>
                        <p>Check back soon for new book requests!</p>
                    </div>
                `;
            }
        }

        function renderGiftedBookList() {
            const giftedBookList = document.getElementById('giftedBookList');
            const giftedBooks = bookRequests.filter(book => book.fulfilled);
            
            // Update stats
            document.getElementById('giftedCount').textContent = giftedBooks.length;
            const totalValue = giftedBooks.reduce((sum, book) => {
                const price = parseFloat(book.price.replace('$', '').replace(',', ''));
                return sum + (isNaN(price) ? 0 : price);
            }, 0);
            document.getElementById('giftedValue').textContent = '$' + totalValue.toFixed(2);
            
            giftedBookList.innerHTML = '';
            
            if (giftedBooks.length === 0) {
                giftedBookList.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--sepia);">
                        <h3 style="color: var(--gold); margin-bottom: 1rem;">üéÅ No Books Gifted Yet</h3>
                        <p>Be the first generous donor! Check out the Browse Requests tab.</p>
                    </div>
                `;
                return;
            }
            
            giftedBooks.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.className = 'book-item fulfilled';
                bookItem.innerHTML = `
                    <div class="fulfilled-badge">GIFTED</div>
                    <div class="book-title">${book.title}</div>
                    <div class="book-author">by ${book.author}</div>
                    <div class="book-requester">Gifted to ${book.requester}</div>
                    <p style="color: var(--sepia); font-size: 0.95rem; margin-bottom: 1rem; font-style: italic;">"${book.reason}"</p>
                    <div class="book-price">${book.price}</div>
                    <div style="text-align: center; padding: 1.5rem; color: var(--forest); background: rgba(46, 204, 113, 0.1); border-radius: 4px;">
                        <strong style="font-size: 1.1rem;">‚ú® Successfully Gifted!</strong>
                        <p style="margin-top: 0.5rem; font-size: 0.9rem;">Thank you to the generous donor who made this possible!</p>
                    </div>
                `;
                giftedBookList.appendChild(bookItem);
            });
        }

        function renderAllRequestsList(filter = 'all') {
            const allRequestsList = document.getElementById('allRequestsList');
            let booksToShow = bookRequests;
            
            if (filter === 'active') {
                booksToShow = bookRequests.filter(book => !book.fulfilled);
            } else if (filter === 'fulfilled') {
                booksToShow = bookRequests.filter(book => book.fulfilled);
            }
            
            allRequestsList.innerHTML = '';
            
            if (booksToShow.length === 0) {
                allRequestsList.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--sepia);">
                        <h3 style="color: var(--gold); margin-bottom: 1rem;">üìö No Books Found</h3>
                        <p>No books match this filter.</p>
                    </div>
                `;
                return;
            }
            
            booksToShow.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.className = book.fulfilled ? 'book-item fulfilled' : 'book-item';
                bookItem.innerHTML = `
                    ${book.fulfilled ? '<div class="fulfilled-badge">GIFTED</div>' : '<div class="active-badge">ACTIVE</div>'}
                    <div class="book-title">${book.title}</div>
                    <div class="book-author">by ${book.author}</div>
                    <div class="book-requester">Requested by ${book.requester}</div>
                    <p style="color: var(--sepia); font-size: 0.95rem; margin-bottom: 1rem; font-style: italic;">"${book.reason}"</p>
                    ${!book.fulfilled ? `
                        <div style="background: var(--parchment); padding: 0.8rem; border-radius: 4px; margin-bottom: 1rem; font-size: 0.9rem;">
                            <strong>üìß Kindle Email:</strong> ${book.kindleEmail}
                        </div>
                    ` : ''}
                    <div class="book-price">${book.price}</div>
                    ${!book.fulfilled ? `
                        <button class="amazon-btn" onclick="giftBook(${book.id})">
                            üéÅ Buy Kindle Book & Gift to ${book.requester.split(' ')[0]}
                        </button>
                    ` : `
                        <div style="text-align: center; padding: 1rem; color: var(--forest); background: rgba(46, 204, 113, 0.1); border-radius: 4px; margin-top: 1rem;">
                            <strong>‚ú® This book has been gifted! Thank you, kind donor!</strong>
                        </div>
                    `}
                `;
                allRequestsList.appendChild(bookItem);
            });
        }

        function updateFilterCounts() {
            document.getElementById('countAll').textContent = bookRequests.length;
            document.getElementById('countActive').textContent = bookRequests.filter(b => !b.fulfilled).length;
            document.getElementById('countFulfilled').textContent = bookRequests.filter(b => b.fulfilled).length;
        }

        function filterRequests(filter) {
            currentFilter = filter;
            renderAllRequestsList(filter);
            
            // Update button styles
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('filter' + filter.charAt(0).toUpperCase() + filter.slice(1)).classList.add('active');
        }

        function giftBook(bookId) {
            const book = bookRequests.find(b => b.id === bookId);
            if (book && book.amazonLink) {
                const affiliateLink = book.amazonLink + (book.amazonLink.includes('?') ? '&' : '?') + 'tag=samuelkimanis-20';
                
                const confirmed = confirm(
                    `You're about to gift "${book.title}" (Kindle) to ${book.requester}!\n\n` +
                    `IMPORTANT: When purchasing on Amazon:\n` +
                    `1. Click "Buy for someone else" or "Give as a Gift"\n` +
                    `2. Enter this Kindle email address:\n   ${book.kindleEmail}\n` +
                    `3. Complete the purchase\n\n` +
                    `The Kindle book will be delivered instantly to ${book.requester}'s Kindle!\n\n` +
                    `Click OK to continue to Amazon.`
                );
                
                if (confirmed) {
                    showNotification(`Opening Amazon... Use Kindle email: ${book.kindleEmail}`);
                    window.open(affiliateLink, '_blank');
                    
                    setTimeout(() => {
                        const purchased = confirm('Have you completed the Kindle book purchase on Amazon?');
                        if (purchased) {
                            book.fulfilled = true;
                            stats.totalFulfilled++;
                            updateStats();
                            renderBookList();
                            renderDonateBookList();
                            renderGiftedBookList();
                            renderAllRequestsList(currentFilter);
                            updateFilterCounts();
                            showNotification(`Thank you for gifting "${book.title}" to ${book.requester}! üìö‚ù§Ô∏è`);
                        }
                    }, 5000);
                }
            }
        }

        function submitRequest(event) {
            event.preventDefault();
            
            const newRequest = {
                id: bookRequests.length + 1,
                title: document.getElementById('bookTitle').value,
                author: document.getElementById('bookAuthor').value,
                requester: document.getElementById('reqName').value,
                email: document.getElementById('reqEmail').value,
                kindleEmail: document.getElementById('kindleEmail').value,
                reason: document.getElementById('whyBook').value,
                amazonLink: document.getElementById('amazonLink').value,
                price: 'Check Amazon',
                fulfilled: false
            };
            
            bookRequests.push(newRequest);
            stats.totalRequests++;
            
            showNotification('Your Kindle book request has been posted! Donors can now see it. üìñ');
            
            document.getElementById('requestForm').reset();
            updateStats();
            renderBookList();
            renderDonateBookList();
            renderGiftedBookList();
            renderAllRequestsList(currentFilter);
            updateFilterCounts();
            
            setTimeout(() => {
                document.querySelector('[onclick="switchTab(\'browse\')"]').click();
            }, 1500);
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        init();
    </script>
</body>
</html>
